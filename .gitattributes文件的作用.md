# .gitattributes

## 介绍

.gitattributes 是一个文本文件，文件中的一行定义一个路径的若干个属性，主要用于定义每种文件的属性，以方便 git 帮我们统一管理。

+ .gitattributes 文件格式如下：

> 要匹配的文件模式 属性1 属性2 ...

在.gitattributes文件的一行中，一个属性（以text属性为例）可能有4种状态：

+ 设置text
+ 不设置-text
+ 设置值text=string
+ 未声明，通常不出现该属性即可；但是为了覆盖其他文件中的声明，也可以!text

## .gitattributes 文件中可以定义的属性

### text

用于控制行尾的规范性。如果一个文本文件是规范的，则Git库汇总该文件（git 服务器上的文件）的行尾总是LF。对于工作目录，除了text属性之外，还可以设置eol属性或core.eol配置变量。

### eol

设置行末字符。

+ eol=lf ，[回车] ：入库时将行尾规范为LF，检出时行尾不强制转换为 CRLF
+ eol=crlf，[换行、回车] ：入库时将行尾规范为LF，检出时将行尾转换为CRLF

> 补充：CRLF 和 LF
GRLF 和 LF都是用来表示文本换行的方式。CR代表回车，对应字符 \r。LF 表示换行，对应字符 \n。不同操作系统文本使用的换行符各不相同。Windows系统使用的是 CRLF，Unix系统（包括Linux，MacOS近些年的版本）使用的是 LF。

> 补充：为什么需要去关心行尾是什么
事实上，可能并不是所有的开发者用的环境都完全一样，比如有的开发者使用 Windows 环境开发，他们的文本文件的换行符是 ‘\r\n’（CRLF）；而有的开发者使用 MacOS 环境开发，这些开发者文本文件的换行符是 ‘\n’（LF）。为了使得不同系统环境的开发者能开发同一个git项目，便出现了这个。

### diff

我们知道 git 主要是用来跟踪文件版本的，跟踪文件版本自然离不开比较差异，而diff 就是用来告诉 git 声明文件需要比较版本差异的。
diff属性影响Git对特殊文件生成差异的方式。它可以告诉Git是否为路径生成文本补丁还是将路径视为二进制文件。它也可以影响在hunk头部显示的@@ -k,l +n,m @@，告诉Git使用外部命令来生成差异，或者是在生成差异之前让Git将二进制文件转换为文本文件。

+ diff
强制视为文本文件，即使它包含一些通常从不会出现在文本文件的字节值，例如NUL。

+ !diff
表示为非文本文件，没有设置diff属性的路径会生成differ二进制文件（如果启用了二进制补丁，会生成二进制补丁）。

+ 未定义
未指明diff属性的路径首先会检查其内容，如果它看起来像文本文件并且小于大文件阈值（core.bigFileThreshold），则将其视为文本文件，否则将生成differ二进制文件。

> core.bigFileThreshold：所有平台上的默认值为512MiB。大于此大小的文件将被缩减，而不会尝试增量压缩。

### differ 规则

diff 是使用指定的 diff 驱动程序显示的。每个驱动程序可以指定一个或多个选项。

+ 如何自定义一个外部的diff驱动程序？
diff驱动程序的定义是在gitconfig中完成的，并不是在gitattributes文件中，所以严格来说，这里并不适合谈论它。
